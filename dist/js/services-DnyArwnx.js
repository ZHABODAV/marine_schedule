import{a}from"./vendor-axios-CcrxTH1M.js";const t=a.create({baseURL:"http://localhost:5000/api",timeout:3e4,headers:{"Content-Type":"application/json"}});function e(a){if(!a.response)return a.request?"Network error. Please check your connection.":a.message||"An unexpected error occurred.";{const t=a.response.status,e=a.response.data;switch(t){case 400:return e?.message||"Bad request. Please check your input.";case 401:return"Unauthorized. Please login again.";case 403:return"Forbidden. You do not have permission to access this resource.";case 404:return e?.message||"Resource not found.";case 422:return e?.message||"Validation error.";case 500:return"Internal server error. Please try again later.";case 503:return"Service unavailable. Please try again later.";default:return e?.message||`Error: ${t}`}}}t.interceptors.request.use(a=>{const t=localStorage.getItem("auth_token");return t&&(a.headers.Authorization=`Bearer ${t}`),a},a=>Promise.reject(a)),t.interceptors.response.use(a=>a,a=>(e(a),Promise.reject(a)));const s=new class{constructor(){this.baseUrl="/vessels"}async getAll(a){const e=a?{module:a}:{};return(await t.get(this.baseUrl,{params:e})).data.data}async getPaginated(a=1,e=10,s){return(await t.get(this.baseUrl,{params:{page:a,per_page:e,...s}})).data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async getPositions(){return(await t.get(`${this.baseUrl}/positions`)).data.data}async getSchedule(a,e,s){const r={start_date:e,end_date:s};return(await t.get(`${this.baseUrl}/${a}/schedule`,{params:r})).data.data}async import(a){const e=new FormData;return e.append("file",a),(await t.post(`${this.baseUrl}/import`,e,{headers:{"Content-Type":"multipart/form-data"}})).data.data}async export(a="excel"){return(await t.get(`${this.baseUrl}/export`,{params:{format:a},responseType:"blob"})).data}},r=new class{constructor(){this.baseUrl="/cargo"}async getAll(a){const e=a?{module:a}:{};return(await t.get(this.baseUrl,{params:e})).data.data}async getPaginated(a=1,e=10,s){return(await t.get(this.baseUrl,{params:{page:a,per_page:e,...s}})).data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async getByPort(a){return(await t.get(`${this.baseUrl}/port/${a}`)).data.data}async getStatistics(a,e,s){const r={start_date:a,end_date:e,module:s};return(await t.get(`${this.baseUrl}/statistics`,{params:r})).data.data}async import(a){const e=new FormData;return e.append("file",a),(await t.post(`${this.baseUrl}/import`,e,{headers:{"Content-Type":"multipart/form-data"}})).data.data}async export(a="excel"){return(await t.get(`${this.baseUrl}/export`,{params:{format:a},responseType:"blob"})).data}},n=new class{constructor(){this.baseUrl="/routes"}async getAll(a){const e=a?{module:a}:{};return(await t.get(this.baseUrl,{params:e})).data.data}async getPaginated(a=1,e=10,s){return(await t.get(this.baseUrl,{params:{page:a,per_page:e,...s}})).data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async calculateDistance(a,e,s){return(await t.post(`${this.baseUrl}/calculate-distance`,{from_port:a,to_port:e,via_canals:s})).data.data.distance}async getOptimalRoute(a,e,s){return(await t.get(`${this.baseUrl}/optimal`,{params:{from_port:a,to_port:e,vessel_type:s}})).data.data}},i=new class{constructor(){this.baseUrl="/ports"}async getAll(a){const e=a?{module:a}:{};return(await t.get(this.baseUrl,{params:e})).data.data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async getSchedule(a,e,s){const r={start_date:e,end_date:s};return(await t.get(`${this.baseUrl}/${a}/schedule`,{params:r})).data.data}async getBerthAvailability(a,e){const s=e?{date:e}:{};return(await t.get(`${this.baseUrl}/${a}/berths`,{params:s})).data.data}},o=new class{constructor(){this.baseUrl="/voyages"}async getAll(a){const e=a?{module:a}:{};return(await t.get(this.baseUrl,{params:e})).data.data}async getPaginated(a=1,e=10,s){return(await t.get(this.baseUrl,{params:{page:a,per_page:e,...s}})).data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async calculate(a){return(await t.post(`${this.baseUrl}/calculate`,a)).data.data}async optimize(a,e){return(await t.post(`${this.baseUrl}/${a}/optimize`,e)).data.data}async getFinancials(a){return(await t.get(`${this.baseUrl}/${a}/financials`)).data.data}async export(a,e="excel"){return(await t.get(`${this.baseUrl}/${a}/export`,{params:{format:e},responseType:"blob"})).data}async generateSchedule(a){return(await t.post(`${this.baseUrl}/generate-schedule`,a)).data.data}},c=new class{constructor(){this.baseUrl="/voyage-templates"}async getAll(){return(await t.get(this.baseUrl)).data.data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async apply(a,e){return(await t.post(`${this.baseUrl}/${a}/apply`,e)).data.data}},l=new class{constructor(){this.baseUrl="/scenarios"}async getAll(){return(await t.get(this.baseUrl)).data.data}async getById(a){return(await t.get(`${this.baseUrl}/${a}`)).data.data}async create(a){return(await t.post(this.baseUrl,a)).data.data}async update(a,e){return(await t.put(`${this.baseUrl}/${a}`,e)).data.data}async delete(a){await t.delete(`${this.baseUrl}/${a}`)}async compare(a){return(await t.post(`${this.baseUrl}/compare`,{scenario_ids:a})).data.data}};async function d(){try{const a=await fetch("/api/network/export",{method:"POST",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to export network snapshot");const t=await a.blob(),e=window.URL.createObjectURL(t),s=document.createElement("a");s.href=e,s.download=`network_snapshot_${(new Date).toISOString().slice(0,10)}.xlsx`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(e)}catch(a){throw a}}const p={ballast:{label:"Б",class:"ballast"},loading:{label:"П",class:"loading"},transit:{label:"Т",class:"transit"},discharge:{label:"В",class:"discharge"},canal:{label:"К",class:"canal"},bunker:{label:"Ф",class:"bunker"},waiting:{label:"О",class:"waiting"}};async function u(a,t=30){const e=[],s=new Date;return Array.from(new Set(a.map(a=>a.vesselId||a.vessel))).map(t=>({id:t,name:a.find(a=>(a.vesselId||a.vessel)===t)?.vessel||String(t)})).forEach(r=>{const n={vessel:r.name,days:[]};for(let a=0;a<t;a++)n.days.push({operation:"",class:""});a.filter(a=>(a.vesselId||a.vessel)===r.id).forEach(a=>{const e=new Date(a.startDate),r=Math.floor((e.getTime()-s.getTime())/864e5);if(r<0||r>=t)return;let i=r;a.legs&&a.legs.forEach(a=>{const e=Math.ceil((a.duration||0)/24),s=p[a.type]||{label:"?",class:"waiting"};for(let r=0;r<e&&i<t;r++)i>=0&&(n.days[i]={operation:s.label,class:s.class}),i++})}),e.push(n)}),e}async function h(a=30){try{const t=await fetch("/api/gantt-data");if(!t.ok)throw new Error("Failed to fetch Gantt data from API");return function(a,t=30){const e=[],s=new Date;return Object.keys(a).forEach(r=>{const n=a[r],i={vessel:r,days:[]};for(let a=0;a<t;a++)i.days.push({operation:"",class:""});n?.forEach(a=>{if(a.start_time&&a.end_time){const e=new Date(a.start_time),r=new Date(a.end_time),n=Math.ceil((r.getTime()-e.getTime())/864e5),o=Math.floor((e.getTime()-s.getTime())/864e5);if(o>=0&&o<t){const e=p[a.leg_type||a.type]||{label:"?",class:"waiting"};for(let a=0;a<n&&o+a<t;a++)i.days[o+a]={operation:e.label,class:e.class}}}}),e.push(i)}),e}((await t.json()).assets||{},a)}catch(t){return[]}}async function g(){const a=new Date,t=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,e=await fetch("/api/export/excel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"gantt",year_month:t})});if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to export Gantt chart")}const s=await e.blob(),r=window.URL.createObjectURL(s),n=document.createElement("a");n.href=r,n.download=`gantt_chart_${t}.xlsx`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}async function y(a,t,e,s={}){{const a=await fetch("/api/financial/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(a.ok)return await a.json()}const r=[],n=r.length>0?r.reduce((a,t)=>a+t.tce,0)/r.length:0;return{voyages:r,totalVoyages:r.length,totalRevenue:Math.round(0),totalCosts:Math.round(0),totalProfit:Math.round(0),avgTCE:n,totalDistance:0,totalDays:0}}async function w(){try{const a=await fetch("/api/bunker/optimize",{method:"POST",headers:{"Content-Type":"application/json"}});return a.ok?await a.json():{success:!0,savings:5e4,message:"Client-side optimization estimate"}}catch(a){throw a}}export{h as a,d as b,y as c,o as d,g as e,c as f,u as g,e as h,r as i,w as o,i as p,n as r,l as s,s as v};
//# sourceMappingURL=services-DnyArwnx.js.map
