{"version":3,"file":"component-gantt-_NkoJ77a.js","sources":["../../src/components/gantt/GanttChart.vue"],"sourcesContent":["<template>\n  <div class=\"gantt-chart-container\">\n    <div class=\"gantt-controls\">\n      <div class=\"control-group\">\n        <label for=\"gantt-days\">Timeline Days:</label>\n        <input\n          id=\"gantt-days\"\n          v-model.number=\"timelineDays\"\n          type=\"number\"\n          min=\"7\"\n          max=\"365\"\n          class=\"form-control\"\n        />\n      </div>\n      \n      <div class=\"control-group\">\n        <label for=\"voyage-filter\">Voyage Filter:</label>\n        <select id=\"voyage-filter\" v-model=\"voyageFilter\" class=\"form-control\">\n          <option value=\"all\">All Voyages</option>\n          <option value=\"active\">Active Only</option>\n          <option value=\"planned\">Planned Only</option>\n          <option value=\"custom\">Custom Selection</option>\n        </select>\n      </div>\n\n      <div class=\"button-group\">\n        <button @click=\"refreshGantt\" class=\"btn btn-primary\">\n          <span v-if=\"isLoading\">Loading...</span>\n          <span v-else>Refresh</span>\n        </button>\n        <button @click=\"exportGantt\" class=\"btn btn-secondary\">\n          Export\n        </button>\n      </div>\n    </div>\n\n    <div v-if=\"error\" class=\"alert alert-error\">\n      {{ error }}\n    </div>\n\n    <div v-if=\"isLoading\" class=\"loading-state\">\n      <LoadingSpinner />\n      <p>Generating Gantt chart...</p>\n    </div>\n\n    <div v-else-if=\"ganttData.length === 0\" class=\"empty-state\">\n      <p>No voyage data available. Generate a schedule first.</p>\n    </div>\n\n    <div v-else class=\"gantt-chart\" ref=\"ganttContainer\">\n      <div class=\"gantt-legend\">\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-loading\"></span>\n          П - Loading (Погрузка)\n        </span>\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-discharge\"></span>\n          В - Discharge (Выгрузка)\n        </span>\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-transit\"></span>\n          Т - Transit (Транзит)\n        </span>\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-ballast\"></span>\n          Б - Ballast (Балласт)\n        </span>\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-canal\"></span>\n          К - Canal (Канал)\n        </span>\n        <span class=\"legend-item\">\n          <span class=\"legend-color op-bunker\"></span>\n          Ф - Bunker (Бункеровка)\n        </span>\n      </div>\n\n      <table class=\"gantt-table\">\n        <thead>\n          <tr>\n            <th class=\"vessel-header\">Vessel</th>\n            <th v-for=\"day in timelineDays\" :key=\"day\" class=\"day-header\">\n              {{ day }}\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"row in ganttData\" :key=\"row.vessel\">\n            <th class=\"vessel-name\">{{ row.vessel }}</th>\n            <td\n              v-for=\"(day, index) in row.days\"\n              :key=\"index\"\n              :class=\"['gantt-cell', day.class ? `op-${day.class}` : '']\"\n              :title=\"getCellTitle(row.vessel, index, day)\"\n            >\n              {{ day.operation }}\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <div v-if=\"ganttData.length > 0\" class=\"gantt-stats\">\n      <div class=\"stat-card\">\n        <h4>Vessels</h4>\n        <p class=\"stat-value\">{{ ganttData.length }}</p>\n      </div>\n      <div class=\"stat-card\">\n        <h4>Timeline</h4>\n        <p class=\"stat-value\">{{ timelineDays }} days</p>\n      </div>\n      <div class=\"stat-card\">\n        <h4>Operations</h4>\n        <p class=\"stat-value\">{{ totalOperations }}</p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, watch } from 'vue'\nimport { useVoyageStore } from '@/stores/voyage'\nimport { useVesselStore } from '@/stores/vessel'\nimport LoadingSpinner from '@/components/shared/LoadingSpinner.vue'\nimport { generateGanttData, generateGanttFromVoyages, exportGantt as exportGanttXLS } from '@/services/gantt.service'\n\ninterface GanttDay {\n  operation: string\n  class: string\n}\n\ninterface GanttRow {\n  vessel: string\n  days: GanttDay[]\n}\n\nconst voyageStore = useVoyageStore()\nconst vesselStore = useVesselStore()\n\nconst ganttContainer = ref<HTMLElement | null>(null)\nconst timelineDays = ref(30)\nconst voyageFilter = ref('all')\nconst isLoading = ref(false)\nconst error = ref('')\nconst ganttData = ref<GanttRow[]>([])\n\nconst totalOperations = computed(() => {\n  return ganttData.value.reduce((total, row) => {\n    return total + row.days.filter(day => day.operation).length\n  }, 0)\n})\n\nconst refreshGantt = async () => {\n  isLoading.value = true\n  error.value = ''\n  \n  try {\n    // Get voyages from store\n    const voyages = voyageStore.voyages\n    \n    if (voyages.length > 0) {\n      ganttData.value = await generateGanttFromVoyages(voyages, timelineDays.value)\n    } else {\n      // Fallback to generate from API\n      ganttData.value = await generateGanttData(timelineDays.value)\n    }\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : 'Failed to generate Gantt chart'\n    console.error('Gantt generation error:', err)\n  } finally {\n    isLoading.value = false\n  }\n}\n\nconst exportGantt = async () => {\n  try {\n    await exportGanttXLS()\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : 'Failed to export Gantt chart'\n  }\n}\n\nconst getCellTitle = (vessel: string, dayIndex: number, day: GanttDay): string => {\n  if (!day.operation) return ''\n  \n  const operationNames: Record<string, string> = {\n    'loading': 'Loading Port',\n    'discharge': 'Discharge Port',\n    'transit': 'Sea Transit',\n    'ballast': 'Ballast Voyage',\n    'canal': 'Canal Transit',\n    'bunker': 'Bunkering',\n    'waiting': 'Waiting'\n  }\n  \n  return `${vessel} - Day ${dayIndex + 1}: ${operationNames[day.class] || day.class}`\n}\n\n// Watch for changes in timeline days\nwatch(timelineDays, () => {\n  refreshGantt()\n})\n\n// Initial load\nonMounted(() => {\n  refreshGantt()\n})\n</script>\n\n<style scoped>\n.gantt-chart-container {\n  width: 100%;\n  padding: 1.5rem;\n  background: var(--bg-primary);\n  border-radius: 8px;\n}\n\n.gantt-controls {\n  display: flex;\n  gap: 1.5rem;\n  align-items: center;\n  margin-bottom: 1.5rem;\n  flex-wrap: wrap;\n}\n\n.control-group {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.control-group label {\n  font-weight: 500;\n  color: var(--text-primary);\n  white-space: nowrap;\n}\n\n.form-control {\n  padding: 0.5rem;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  background: var(--bg-secondary);\n  color: var(--text-primary);\n  min-width: 100px;\n}\n\n.button-group {\n  display: flex;\n  gap: 0.5rem;\n  margin-left: auto;\n}\n\n.btn {\n  padding: 0.5rem 1rem;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: 500;\n  transition: all 0.2s;\n}\n\n.btn-primary {\n  background: var(--accent-primary);\n  color: white;\n}\n\n.btn-primary:hover {\n  background: var(--accent-primary-dark);\n}\n\n.btn-secondary {\n  background: var(--bg-secondary);\n  color: var(--text-primary);\n  border: 1px solid var(--border-color);\n}\n\n.btn-secondary:hover {\n  background: var(--bg-tertiary);\n}\n\n.alert {\n  padding: 1rem;\n  border-radius: 4px;\n  margin-bottom: 1rem;\n}\n\n.alert-error {\n  background: var(--accent-danger-light);\n  color: var(--accent-danger);\n  border-left: 4px solid var(--accent-danger);\n}\n\n.loading-state,\n.empty-state {\n  text-align: center;\n  padding: 3rem;\n  color: var(--text-secondary);\n}\n\n.gantt-legend {\n  display: flex;\n  gap: 1.5rem;\n  margin-bottom: 1rem;\n  flex-wrap: wrap;\n  padding: 1rem;\n  background: var(--bg-secondary);\n  border-radius: 4px;\n}\n\n.legend-item {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.875rem;\n  color: var(--text-primary);\n}\n\n.legend-color {\n  width: 20px;\n  height: 20px;\n  border-radius: 3px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.gantt-chart {\n  overflow-x: auto;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.gantt-table {\n  width: 100%;\n  border-collapse: collapse;\n  background: var(--bg-secondary);\n}\n\n.gantt-table thead {\n  position: sticky;\n  top: 0;\n  background: var(--bg-primary);\n  z-index: 10;\n}\n\n.vessel-header {\n  position: sticky;\n  left: 0;\n  background: var(--bg-primary);\n  z-index: 11;\n  padding: 0.75rem 1rem;\n  text-align: left;\n  border: 1px solid var(--border-color);\n  min-width: 150px;\n}\n\n.day-header {\n  padding: 0.5rem;\n  text-align: center;\n  border: 1px solid var(--border-color);\n  min-width: 40px;\n  font-size: 0.75rem;\n  color: var(--text-secondary);\n}\n\n.vessel-name {\n  position: sticky;\n  left: 0;\n  background: var(--bg-secondary);\n  padding: 0.75rem 1rem;\n  text-align: left;\n  border: 1px solid var(--border-color);\n  font-weight: 500;\n  color: var(--text-primary);\n  z-index: 5;\n}\n\n.gantt-cell {\n  padding: 0.5rem;\n  text-align: center;\n  border: 1px solid var(--border-color);\n  font-weight: 600;\n  font-size: 0.875rem;\n  min-width: 40px;\n  transition: all 0.2s;\n  cursor: default;\n}\n\n.gantt-cell:hover {\n  transform: scale(1.1);\n  z-index: 20;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n.op-loading {\n  background: #00b894;\n  color: white;\n}\n\n.op-discharge {\n  background: #0984e3;\n  color: white;\n}\n\n.op-transit {\n  background: #6c5ce7;\n  color: white;\n}\n\n.op-ballast {\n  background: #fdcb6e;\n  color: #2d3436;\n}\n\n.op-canal {\n  background: #e17055;\n  color: white;\n}\n\n.op-bunker {\n  background: #fd79a8;\n  color: white;\n}\n\n.op-waiting {\n  background: #b2bec3;\n  color: #2d3436;\n}\n\n.gantt-stats {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1rem;\n  margin-top: 1.5rem;\n}\n\n.stat-card {\n  background: var(--bg-secondary);\n  padding: 1.5rem;\n  border-radius: 8px;\n  text-align: center;\n  border: 1px solid var(--border-color);\n}\n\n.stat-card h4 {\n  margin: 0 0 0.5rem 0;\n  color: var(--text-secondary);\n  font-size: 0.875rem;\n  font-weight: 500;\n  text-transform: uppercase;\n}\n\n.stat-value {\n  margin: 0;\n  font-size: 2rem;\n  font-weight: 700;\n  color: var(--accent-primary);\n}\n</style>\n"],"names":["voyageStore","useVoyageStore","useVesselStore","ganttContainer","ref","timelineDays","voyageFilter","isLoading","error","ganttData","totalOperations","computed","value","reduce","total","row","days","filter","day","operation","length","refreshGantt","async","voyages","generateGanttFromVoyages","generateGanttData","err","Error","message","exportGantt","exportGanttXLS","getCellTitle","vessel","dayIndex","loading","discharge","transit","ballast","canal","bunker","waiting","class","watch","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","for","id","$event","type","min","max","number","_hoisted_4","_hoisted_5","onClick","_hoisted_8","_toDisplayString","_hoisted_9","_createVNode","LoadingSpinner","_hoisted_10","_hoisted_11","_Fragment","_renderList","key","_hoisted_12","index","title","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20"],"mappings":"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"}